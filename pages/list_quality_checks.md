# List of quality checks implemented

| ID |                Check type                |                                                            Description                                                            |                                                           Comment                                                           |        Reference       |                                                                      Link                                                                     |
|:--:|:----------------------------------------:|:---------------------------------------------------------------------------------------------------------------------------------:|:---------------------------------------------------------------------------------------------------------------------------:|:----------------------:|:---------------------------------------------------------------------------------------------------------------------------------------------:|
| 1  | Is Vannmiljø code unique?                | Ensure all stations have a unique Vannmiljø code                                                                                  | Enforced as database constraint                                                                                             | Notebook 01, section 2 |                                                                                                                                               |
| 2  | Require station metadata                 | Ensure all stations have metadata for: fylke, vassdrag, station_name, vannmiljo_code, liming_status   and geospatial co-ordinates | Enforced as database constraint                                                                                             | Notebook 01, section 2 |                                                                                                                                               |
| 3  | Is sample unique?                        | Requires the combination of (vannmiljo_code, sample_date, depth1, depth2, parameter) to be unique                                 | Enforced as database constraint. May need to be relaxed?                                                                    | Notebook 01, section 2 |                                                                                                                                               |
| 4  | Check parameters and units               | Ensures parameter names are recognised and units are as expected                                                                  | Enforced as database constraint. Note: does not check that values match units, only that the stated units are   as expected | Notebook 01, section 2 |                                                                                                                                               |
| 5  | Require sample metadata                  | Ensures all samples have metadata for: vannmiljo_code, sample_date, lab, period, parameter, value,   unit                         | Enforced as database constraint                                                                                             | Notebook 01, section 2 |                                                                                                                                               |
| 6  | Review station locations                 | Check geospatial co-ordinates are reasonable                                                                                      | Requires manual review of station map                                                                                       | Notebook 01, section 3 | [Station map](https://nivanorge.github.io/tiltaksovervakingen/pages/stn_map.html)                                                             |
| 7  | Check duplicates in historic data        | Identify (and remove/average) duplicates in the Vannmiljø reference dataset                                                       |                                                                                                                             | Notebook 01, section 5 | [Vannmiljø duplicates](https://github.com/NIVANorge/tiltaksovervakingen/blob/master/output/vannmiljo_duplicates.csv)                          |
| 8  | Check basic formatting for "new" dataset | Ensure consistent date format and decimal separator; check values are numeric; remove missing data                                |                                                                                                                             | Notebook 01, section 6 | [Parse input template](https://github.com/NIVANorge/tiltaksovervakingen/blob/1ac96848204f9a0685e1626d5c0377b28d4111c4/notebooks/utils.py#L26) |
| 9  | Check duplicates in "new" dataset        | Identify (and remove/average) duplicates in the "new" lab dataset                                                                 |                                                                                                                             | Notebook 01, section 6 | [VestfoldLAB duplicates](https://github.com/NIVANorge/tiltaksovervakingen/blob/master/output/vestfoldlab_duplicates.csv)                      |
| 10 | Check data ranges                        | Check parameter values in "historic" and "new" datasets are within plausible ranges                                               | Out-of-range values in the historic dataset are removed; in the "new" dataset they they kept   but flagged                  | Notebook 01, section 8 | [Range check](https://github.com/NIVANorge/tiltaksovervakingen/blob/1ac96848204f9a0685e1626d5c0377b28d4111c4/notebooks/utils.py#L246)         |
| 11 | Visualise distributions                  | Use strip plots, Q-Q plots and distribution plots to identify major outliers for individual parameters                            | Requires manual review                                                                                                      | Notebook 02            | [Distribution plots](https://nivanorge.github.io/tiltaksovervakingen/pages/distribution_plots.html)                                           |
| 12 | Outlier/novelty detection                | Apply the isolation forest algorithm to identify outliers at the water sample level                                               | Requires tuning to set the propertion of outliers                                                                           | Notebook 03, section 4 | [VestfoldLAB isolation forest outliers](https://github.com/NIVANorge/tiltaksovervakingen/blob/master/output/vestfoldlab_isoforest_ca_ph.csv)  |
| 13 | Check sampling frequency                 | Compare the number of samples per month and per site to historic ranges                                                           | Highlights if the number of samples per site and month in the "new" dataset is lower than the   historic minimum            | Notebook 04, section 2 | [VestfoldLAB low sampling frequency](https://github.com/NIVANorge/tiltaksovervakingen/blob/master/output/samp_freq_below_historic_min.csv)    |